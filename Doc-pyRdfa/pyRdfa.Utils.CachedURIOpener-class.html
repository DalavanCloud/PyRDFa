<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>pyRdfa.Utils.CachedURIOpener</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="pyRdfa-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="pyRdfa-module.html">Package&nbsp;pyRdfa</a> ::
        <a href="pyRdfa.Utils-module.html">Module&nbsp;Utils</a> ::
        Class&nbsp;CachedURIOpener
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="pyRdfa.Utils.CachedURIOpener-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class CachedURIOpener</h1><p class="nomargin-top"><span class="codelink"><a href="pyRdfa.Utils-pysrc.html#CachedURIOpener">source&nbsp;code</a></span></p>
<pre class="base-tree">
<a href="pyRdfa.Utils.URIOpener-class.html">URIOpener</a> --+
            |
           <strong class="uidshort">CachedURIOpener</strong>
</pre>

<hr />
<p>Implementation of a simple chaching mechanism for opening URI-s. The 
  fundamental idea is that some URI-s have a cached version (or an 
  equivalent) version in the local file space, and that file is loaded 
  instead of getting to the Web with another request.</p>
  <p>The essence is to find a dictionary that maps URI-s to local file 
  names. Instead of hardcoding the location of the chached files, an 
  environment variable is used; this environment variable is an input 
  argument to the class' constructor (<code>cached_env</code>).</p>
  <p>The environment variable plays two roles:</p>
  <ul>
    <li>
      the value of the environment variable provides a directory in the 
      local file space to locate cached files
    </li>
    <li>
      the environment variable itself servers as a Python module name; that
      module, when imported, should include the 'index' dictionary to map 
      URI-s to cached files.
    </li>
  </ul>
  <p>For example, if the cached environment variable is 
  <code>cached_profiles</code>, then</p>
  <ul>
    <li>
      the environment variable <code>cached_profiles</code> may be set to 
      <code>&quot;/Users/ivan/W3C/WWW/2007/08/pyRdfa/profiles&quot;</code>
    </li>
    <li>
      the module 
      <code>&quot;/Users/ivan/W3C/WWW/2007/08/pyRdfa/profiles/cached_profile.py&quot;</code>
      is (dynamically) imported
    </li>
    <li>
      the index dictionary in that profile may contain the entry: 
      <code>&quot;http://www.w3.org/2007/08/pyRdfa/profiles/cc.html&quot;:&quot;cc.html&quot;</code>,
      meaning that if the requested URI is: 
      <code>&quot;http://www.w3.org/2007/08/pyRdfa/profiles/cc.html&quot;</code>
      then the class loads the following local file instead: 
      <code>&quot;/Users/ivan/W3C/WWW/2007/08/pyRdfa/profiles/cc.html&quot;</code>
    </li>
  </ul>
  <p>Furthermore, the class may be initialized with additional (HTTP) 
  Accept headers. This means that if the index dictionary does not contain 
  an entry for the incoming URI, suffixes for the content types in the 
  Accept headers will be used to check again (in case that content type is 
  known). Ie, if the requested URI is: 
  <code>&quot;http://www.w3.org/2007/08/pyRdfa/profiles/cc&quot;</code> and
  the additonal accept header includes 'text/html' then the: 
  <code>&quot;http://www.w3.org/2007/08/pyRdfa/profiles/cc.html&quot;</code>
  is also checked. This is a crude local imitation of HTTP content 
  negotiation.</p>
  <p>Obviously, if the cache mechanism fails at any place in finding a 
  local copy, the superclass, ie, a proper HTTP request, is used.</p>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyRdfa.Utils.CachedURIOpener-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">uri</span>,
        <span class="summary-sig-arg">additional_headers</span>=<span class="summary-sig-default"><code class="variable-group">{</code><code class="variable-group">}</code></span>,
        <span class="summary-sig-arg">cached_env</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string"></code><code class="variable-quote">'</code></span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="pyRdfa.Utils-pysrc.html#CachedURIOpener.__init__">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyRdfa.Utils.CachedURIOpener-class.html#_resolve_cache" class="summary-sig-name" onclick="show_private();">_resolve_cache</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">uri</span>,
        <span class="summary-sig-arg">additional_headers</span>)</span><br />
      Resolve the cache.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="pyRdfa.Utils-pysrc.html#CachedURIOpener._resolve_cache">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="pyRdfa.Utils.CachedURIOpener-class.html#_resolve_uri" class="summary-sig-name" onclick="show_private();">_resolve_uri</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">uri</span>,
        <span class="summary-sig-arg">content_type</span>=<span class="summary-sig-default">None</span>)</span><br />
      The real cache resolver; only deals with one URI and not with the 
      possible fake content negotiation; that is handled by the caller.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="pyRdfa.Utils-pysrc.html#CachedURIOpener._resolve_uri">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== CLASS VARIABLES ==================== -->
<a name="section-ClassVariables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Class Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-ClassVariables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="loaded_modules"></a><span class="summary-name">loaded_modules</span> = <code title="{}"><code class="variable-group">{</code><code class="variable-group">}</code></code>
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="pyRdfa.Utils.URIOpener-class.html">URIOpener</a></code></b>:
      <code><a href="pyRdfa.Utils.URIOpener-class.html#CONTENT_LOCATION">CONTENT_LOCATION</a></code>,
      <code><a href="pyRdfa.Utils.URIOpener-class.html#CONTENT_TYPE">CONTENT_TYPE</a></code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== INSTANCE VARIABLES ==================== -->
<a name="section-InstanceVariables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceVariables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="pyRdfa.Utils.URIOpener-class.html">URIOpener</a></code></b>:
      <code><a href="pyRdfa.Utils.URIOpener-class.html#content_type">content_type</a></code>,
      <code><a href="pyRdfa.Utils.URIOpener-class.html#data">data</a></code>,
      <code><a href="pyRdfa.Utils.URIOpener-class.html#headers">headers</a></code>,
      <code><a href="pyRdfa.Utils.URIOpener-class.html#location">location</a></code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">uri</span>,
        <span class="sig-arg">additional_headers</span>=<span class="sig-default"><code class="variable-group">{</code><code class="variable-group">}</code></span>,
        <span class="sig-arg">cached_env</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string"></code><code class="variable-quote">'</code></span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="pyRdfa.Utils-pysrc.html#CachedURIOpener.__init__">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>uri</code></strong> - URL to be opened</li>
        <li><strong class="pname"><code>additional_headers</code></strong> - additional HTTP request headers to be added to the call</li>
        <li><strong class="pname"><code>cached_env</code></strong> - the environment variable name the directs the caching</li>
    </ul></dd>
    <dt>Overrides:
        <a href="pyRdfa.Utils.URIOpener-class.html#__init__">URIOpener.__init__</a>
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="_resolve_cache"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_resolve_cache</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">uri</span>,
        <span class="sig-arg">additional_headers</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="pyRdfa.Utils-pysrc.html#CachedURIOpener._resolve_cache">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Resolve the cache. If we get here, the index that maps URI-s to local 
  file names is already available; ie, if possible, a local file is opened 
  for a URI. The suffix of that file determines the media type (see 
  preferred_suffixes).</p>
  <p>The additional header is considered to set the right priority in 
  opening a file in case the uri cannot be resolved directly. See the class
  description for the details.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>uri</code></strong> - URL to be opened</li>
        <li><strong class="pname"><code>additional_headers</code></strong> - additional HTTP request headers to be added to the call</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>boolean, signalling whether the caching is successful or not. If 
          not, the caller should initialize the superclass, ie, issue a 
          HTTP GET</dd>
  </dl>
</td></tr></table>
</div>
<a name="_resolve_uri"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_resolve_uri</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">uri</span>,
        <span class="sig-arg">content_type</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="pyRdfa.Utils-pysrc.html#CachedURIOpener._resolve_uri">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>The real cache resolver; only deals with one URI and not with the 
  possible fake content negotiation; that is handled by the caller.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>uri</code></strong> - URL to be opened</li>
        <li><strong class="pname"><code>content_type</code></strong> - if given, sets the content type for the resource (otherwise the 
          suffix decides)</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>boolean, signalling whether the caching is successful or not.</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="pyRdfa-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Dec  1 12:09:02 2010
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
